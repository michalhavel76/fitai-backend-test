import fs from "fs";

const DB_PATH = "src/data/fitai_foods_extended.json";

/**
 * Ulo≈æ√≠ nov√© j√≠dlo do FitAI datab√°ze (pokud tam je≈°tƒõ nen√≠)
 */
export function saveLocalFood(food: any) {
  try {
    const raw = fs.readFileSync(DB_PATH, "utf-8");
    const foods = JSON.parse(raw);

    // u≈æ existuje?
    const exists = foods.some(
      (f: any) => f.name.toLowerCase() === food.name.toLowerCase()
    );

    if (exists) {
      console.log(`‚ÑπÔ∏è Food already exists: ${food.name}`);
      return;
    }

    foods.push(food);
    fs.writeFileSync(DB_PATH, JSON.stringify(foods, null, 2));
    console.log(`üíæ New food saved: ${food.name}`);
  } catch (err) {
    console.error("‚ùå Error saving food:", (err as any).message);
  }
}
